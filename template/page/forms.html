<h1>{{ @VIEWVARS.form.name ?? '' }}</h1>
<p class="lead">{{ @VIEWVARS.form.description ?? '' }}</p>
<form class="needs-validation" method="POST">
    <repeat group="{{ @VIEWVARS.form._controls ?? [] }}" key="{{ @key }}" value="{{ @value }}">

        <check if="@value.type === 'radio'">

            <!--
            <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                <label class="form-check-label" for="flexRadioDefault1">
                    Default radio
                </label>
            </div>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" checked>
                <label class="form-check-label" for="flexRadioDefault2">
                    Default checked radio
                </label>
            </div>
            -->
            <fieldset class="mt-2 p-2 border border-1 rounded {{ (@value._class ?? '') === 'is-invalid' ? 'border-danger' : ((@POST[@value.name] ?? '' ) ? 'border-success' : '') }}">
                <label class="form-check-label mb-2">{{ @value.label }}</label>
                <repeat group="{{ @value.options ?? [] }}" key="{{ @val }}" value="{{ @label }}" counter="{{ @cnt }}">
                    <div class="form-check">
                        <input type="{{ @value.type }}" value="{{ @val }}"
                            class="form-check-input {{ @value._class ?? '' }}" id="{{ @value.name . @cnt }}"
                            name="{{ @value.name }}" {{ @val==(@POST[@value.name] ?? '' ) ? 'checked' : '' }}>
                        <label class="form-check-label" for="{{ @value.name . @cnt }}">{{ @label }}</label>
                        <check if="count(@value.options) === @cnt">
                            <div class="invalid-feedback">{{ @value.feedback_invalid }}</div>
                            <div class="valid-feedback">{{ @value.feedback_valid }}</div>
                        </check>
                    </div>
                </repeat>
            </fieldset>
        </check>

        <check if="@value.type === 'select'">
            <div class="form-floating">
                <select class="form-select mt-2 {{ @value._class ?? '' }}" name="{{ @value.name }}"
                    id="{{ @value.name }}" aria-label="Floating label select example">
                    <option value="">Please select ...</option>
                    <repeat group="{{ @value.options ?? [] }}" key="{{ @val }}" value="{{ @label }}">
                        <option value="{{ @val }}" {{ @val===(@POST[@value.name] ?? '' ) ? 'selected' : '' }}>{{ @label
                            }}</option>
                    </repeat>
                </select>
                <label for="{{ @value.name }}">{{ @value.label }}</label>
                <div class="valid-feedback">{{ @value.feedback_valid }}</div>
                <div id="{{ @value.name }}-feedback" class="invalid-feedback">{{ @value.feedback_invalid }}</div>
            </div>
        </check>


        <check
            if="@value.type === 'text' || @value.type === 'number' ||  @value.type === 'email' || @value.type === 'password'">
            <div class="form-floating">
                <input name="{{ @value.name }}" id="{{ @value.name }}" value="{{ @POST[@value.name] ?? '' }}"
                    aria-describedby="{{ @value.name }}-feedback" class="form-control mt-2 {{ @value._class ?? '' }}"
                    type="{{ @value.type ?? 'text' }}" placeholder="{{ @value.label }}">
                <label for="{{ @value.name }}">{{ @value.label }}</label>
                <div class="valid-feedback">{{ @value.feedback_valid }}</div>
                <div id="{{ @value.name }}-feedback" class="invalid-feedback">{{ @value.feedback_invalid }}</div>
            </div>
        </check>

    </repeat>
    <button class="btn btn-lg btn-primary mt-3" type="submit">{{ @VIEWVARS.form.label_submit ?? 'Submit' }}</button>
</form>